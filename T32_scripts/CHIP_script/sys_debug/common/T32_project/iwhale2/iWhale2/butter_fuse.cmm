LOCAL &romcode
ENTRY &romcode
if "&romcode"==""
	&romcode=0x0
&DC_SEL=0x1
&DC_LEN=0x1c
;&DC_WRITE_DATA="00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001C1C48C7002200010000000000000CB07010004"
;default 2module
;&DC_WRITE_DATA="0000000000000000000000000000000000000000000000000000000000000000000000000000000010DC305B401CB73C4580000000000000000000000000000106E382DC00E5B9E42C000000000000000000000001C1C48C0000000210000000000000CB0751000C"
&DC_WRITE_DATA="000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000CB0750000C"
	

;&DC_WRITE_DATA=0xC
&cur_path=os.ppd()
&DST_DIR=os.ppd()
GLOBALON CMD menutrst do "&DST_DIR/jtag_nTRST.cmm"
GLOBALON CMD menusrst do "&DST_DIR/jtag_SRST.cmm"
GLOBALON CMD menurb do "&DST_DIR/butter.cmm"
GLOBALON CMD menuef do "&DST_DIR/fuse.cmm"
GLOBALON CMD menufgi do "&DST_DIR/fuse_gui.cmm"
GLOBALON CMD menudfgi do "&DST_DIR/fuse_detail_gui.cmm"
GLOBALON CMD menuoeu do "&DST_DIR/orange_unlock.cmm"

menusrst
DO &cur_path/jtag_nTRST.cmm
DO &cur_path/butter.cmm DAP
D.S EAQD:0xE4240024 %LE %Long 0x00000008 
DO &cur_path/jtag_nTRST.cmm

menurb PRERB
DO &cur_path/iWhale2_JTAG.cmm "FUSE"
comOPS jtag_low_lock
lowJTAG jtag_reset_tms
menuef EFUSE_DC_WRITE &DC_LEN &DC_SEL &DC_WRITE_DATA
comOPS jtag_low_unlock
menurb POSTRB
on error CONTINUE 
wait 2.s
S 12
ENDDO
wait 100.ms
if &romcode==0x0
(
	go
	wait 2.s
	break
)
ENDDO	
